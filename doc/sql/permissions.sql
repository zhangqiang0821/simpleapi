-- 权限表
CREATE TABLE IF NOT EXISTS "permissions" (
    id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    code VARCHAR(20) NOT NULL,
    name VARCHAR(20) NOT NULL,
    ctime INT NOT NULL DEFAULT EXTRACT(EPOCH FROM CURRENT_TIMESTAMP)::INT,
    utime INT NOT NULL DEFAULT EXTRACT(EPOCH FROM CURRENT_TIMESTAMP)::INT,
    CONSTRAINT "uq_permissions_code" UNIQUE (code)
)

-- 用户-权限关联表
CREATE TABLE IF NOT EXISTS "users_permissions" (
    id INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    user_id INT NOT NULL,
    permission_id INT NOT NULL,
    ctime INT NOT NULL DEFAULT EXTRACT(EPOCH FROM CURRENT_TIMESTAMP)::INT,
    utime INT NOT NULL DEFAULT EXTRACT(EPOCH FROM CURRENT_TIMESTAMP)::INT
)

alter table permissions add column user_id int;
